sudo: required
language: java
services:
- docker
env:
  global:
    - secure: "BmmMkxKN1+j6HsVT8P1tHrDK/L6ytUGmcWwwF/7i9LLeWuOO7s8EBN8glDURDTK62kbRkYqbv4yKabQqWnH8T5mKMFsqP1+4odgcM29UR264mh+onUms+xlexxW/AouRQOHCK9teFNGz1ZQBW1ee0CtNNzmiZ3OntL95ilRJZpNX2n3jqpz6uAXg7A4hh7A79tEARUISqfB1wnMlLWRtYGOyeGDFBzTc2mA15aYyTpwd7JHYnrd4opYfJEgQ8qjSjFvI6s8quUsJanKpOTCC7iOneRJBsmqT3zNYIxKLnODgJtRD83/4crgNzt/uUhUzZQrmj9Oe4orm8t9wwIY39NgWmN5gwm4og7NFX5SeUUSPpy96JKqv4eZ/dLbrJ3XWFezboQpdl71fwqitJ+rWCuDbWovZiXgYoaP2rbuXJers4+MVtkSKhmdwzLtThiZQGNivj74G+8K7Jbmxf58suam5iMR1M1nJzgPB0K3iMbg7WPm0NA/ls1lrrRfHWlfmiQXYzyJdVx6WPvtKA91Uff3QxMHdPC5ZgFU/H5+hKFPZzMggk8J8qWeIadZW9F/674/Fjk9/2pmoki8Mn8aakhE/renUSYbxL+qDy0Wefs9LAsolhQ5je3Ry/uh1pq2ev7e9NI0gpRv+9fO5JUBh80Jn5YZZQRNn3bA91S1qjXY="
    - secure: "Ai8q8d/nhkKI5kgHTivJm5fOVsDc1uKkvzytQ0SS5oMVA1lwCX3NaNRLLp8TEUUuMGcX/dR2d88dEf+YLkXGlCTMgvnphFVOKU1Wx1UatmseTv6jw0HV/QpxYeL1EsxBNxPnisDfZsldnsaij80Y+uymrAF+a0j+lTrBePPhTZ991aUsT0R92wnaMUo/xtaX9YNQr5jdJQ0iQe+vx6mhcVxMoS9aqIy9DWqQWTWsiZE6cD8eri4svqxHPaTo+FnJCzCy1T0qjn6UETE/R/C4XQNINpw6RrK1XoRXZWLHDFTVj2yyybCZyTjG6CsIYg6j6YiAakwpjcGQxEY3hqKuUNP5fNhqvHOshuFFMkoMbZdmAx4F8uiEuTA/kPqzu4+tijTCdCBr0bO3L3XYaUxd2p6jsXt8WyDSv+JIgrVOEMUvOA/GavxPsgkbOdIgjuelHgOoOOjNM2fb+GgFARlmCP+P2rVbLBj/FugoUti71VdnyNSEN0JA6+R/QsVLk2KVSKKiBzFfkgRRIiKjkzSBx8ENeDyGIeO0rHesNjJMmy5X0BP99QwcdhWcc4nBbj1RToDHcFEhQ5s2GAZeCVJn7r8esFSwL+SlSFWHknueGlhGTm4gT7bSdhqky7e59s5xzWSDvwUssvR1R9c7qnWSZFrKBxQWcyibd0gLB1iovec="
before_install:
- curl -sL https://github.com/nais/naisd/releases/download/127.0.0/nais-127.0.0-linux-amd64.xz | xz -d > nais && chmod +x nais
before_script:
- docker login -u $DOCKER_USERNAME -p $DOCKER_PASSWORD
script:
- "./mvnw test -B"
- nais validate -f hiv/nais.yaml
- nais validate -f hoi/nais.yaml
- nais validate -f testapi/nais.yaml
after_success:
- "./mvnw com.spotify:dockerfile-maven-plugin:push -pl '!dto'"
branches:
  only:
  - master
notifications:
  email: false
